<?xml version="1.0" encoding="UTF-8"?>
<ui:composition
    xmlns:ui="http://java.sun.com/jsf/facelets"
    xmlns:f="http://java.sun.com/jsf/core"
    xmlns:h="http://java.sun.com/jsf/html"
    template="../resources/studentTemplate.xhtml"
    xmlns:j="http://java.sun.com/jsf/composite/components/journal"
    xmlns:news="http://java.sun.com/jsf/composite/components/news"
    xmlns:ut="http://java.sun.com/jsf/composite/components/util"
    xmlns:est="http://java.sun.com/jsf/composite/components/estimation"
    xmlns:fn="http://java.sun.com/jsp/jstl/functions">

    <ui:define name="fio">
        <h:outputText value="#{studentSessionBean.student.fio}"/>
    </ui:define>
    <ui:define name="content">

            <f:metadata>
                <f:viewParam name="s" value="#{badPassedTestsBean.semester}"/>
                <f:viewParam name="s" value="#{lowGradedDisciplinesBean.semester}"/>
                <f:viewParam name="s" value="#{lowGradedCwBean.semester}"/>
            </f:metadata>

        <div class="userFile">
            <div style="width: 9%">
                <ut:showPhoto user="#{studentSessionBean.student}" size="small"/>
            </div>
            <div class="userData" style="width: 91%;">
                <table style="width: 100%;">
                    <tr>
                        <td><p>#{msgs.student_mainContentUserInfoSpec}</p></td>
                        <td><div>#{studentSessionBean.student.group.speciality.name}</div></td>
                        <td colspan="3"><div>#{studentSessionBean.student.surname}
                            #{studentSessionBean.student.name}
                            #{studentSessionBean.student.secondName}
                            </div>
                        </td>
                  
                    </tr>
                    <tr>
                        <td><p>#{msgs.student_mainContentUserInfoGroup}</p></td><td><div>#{studentSessionBean.student.group.name}</div></td>
                    </tr>
                    <tr>
                        <td><p>Ваш рейтинг:</p></td>
                        <td><a class="reitingLink" href="groupRating.xhtml" style="color: green; font-weight: bolder; font-family: Verdana;">#{studentRatingBean.studentRating.sum}</a></td>
                    </tr>
                </table>
                
                <div class="floatDestroyer"></div>
            </div>
            <div class="floatDestroyer"></div>
        </div>
        <div style="padding: 5px;">
            <table style="width: 100%;">
                <tr>
                    <td colspan="2" class="StudentTimeTable">
                        <div style=" border-bottom: 1px solid silver;">
                            <div class="navigationLinks indentionInNavigation"><a style="font-size: 12pt;" href="schedule.xhtml">Расписание видеоконференций</a></div>
                        </div>
                        
                        <h:dataTable columnClasses="
                                     studentStandatrTableTd studentStandatrWidth studentStandatrTableTdWithBorder,
                                     studentStandatrTableTd studentStandatrTableTdWithBorder,
                                     studentStandatrTableTd studentStandatrTableTdWithBorder,
                                     studentStandatrTableTdLastTd studentStandatrTableTdLastTdwithBorder"
                                     value="#{studentScheduleBean.schedule}" var="s" styleClass="studentStandatrTable" cellpadding="0" cellspacing="0">
                            <h:column>
                                <f:facet name="header">
                                    <h:outputText value="#{msgs.student_Dicipline}"/>
                                </f:facet>
                                <span class="controlWorksDisciplineNameLink" style="font-size: 8pt; font-weight: normal !important;"><h:outputLink value="discipline.xhtml?c=#{s.id}"><span style=" font-weight: normal !important;">#{s.discipline.name}</span></h:outputLink>
                                </span>
                            </h:column>
                            <h:column>
                                <f:facet name="header">
                                    <h:outputText value="#{msgs.student_Teacher}"/>
                                </f:facet>
                                <span class="linkToTeachersProfile linkToTeachersProfileFromStudent"><a href="teacher.xhtml?id=#{s.teacher.id}" style="text-indent: 22px;"><h:outputText value="#{s.teacher.initials}"/></a></span>
                            </h:column>
                            <h:column>
                                <f:facet name="header">
                                    <h:outputText value="#{msgs.student_Room}"/>
                                </f:facet>
                                <div style="text-align: center !important;">
                                    <h:outputText value="#{s.room}" style="color: #{s.color}"/>
                                </div>
                            </h:column>
                            <h:column>
                                <f:facet name="header">
                                    <h:outputText value="#{msgs.student_Data}"/>
                                </f:facet>
                                <span ><h:outputText converter="dateConverter" value="#{s.lessonDate}"/></span>
                            </h:column>
                        </h:dataTable>
                    </td>
                </tr>
                <tr>
                    <td colspan="2" class="StudentTimeTable">
                        <table style="width: 100%;" class="studentStandatrTable studentStandatrWidth studentStandatrTableTdWithBorder " cellpadding="0" cellspacing="0">
                            <tr>
                                <th style="width: 25%;">
                                    Событие
                                </th>
                                <th style="width: 25%;">
                                    Дата
                                </th>
                                <th style="width: 25%;">
                                    Событие
                                </th>
                                <th style="width: 25%;">
                                    Дата
                                </th>
                            </tr>
                            <tr>
                                <td class="studentStandatrTableTd studentStandatrTableTdWithBorder">
                                    Открытие тестов
                                </td>
                                <td class="studentStandatrTableTd cent studentStandatrTableTdWithBorder" style="text-align:center !important;">
                                   <h:outputText converter="dateConverter" value="#{resourceService.regularTestBeginDate}"/>
                                </td>
                               <td class="studentStandatrTableTd studentStandatrTableTdWithBorder" >
                                    Закрытие тестов
                                </td>
                                <td class="studentStandatrTableTd studentStandatrTableTdWithBorder" style="text-align:center !important;">
                                    <h:outputText converter="dateConverter" value='#{resourceService.regularTestEndDate}'/>
                                </td>
                            </tr>
                            <tr>
                                <td class="studentStandatrTableTd studentStandatrTableTdWithBorder">
                                    Открытие контрольных
                                </td>
                                <td class="studentStandatrTableTd studentStandatrTableTdWithBorder" style="text-align:center !important;">
                                    <h:outputText converter="dateConverter" value="#{studentIndexBean.getDate('controlWorksBeginDate')}"/>
                                </td>
                                <td class="studentStandatrTableTd studentStandatrTableTdWithBorder" >
                                    Закрытие контрольных
                                </td>
                                <td class="studentStandatrTableTd studentStandatrTableTdWithBorder" style="text-align:center !important;">
                                    <h:outputText converter="dateConverter" value="#{studentIndexBean.getDate('controlWorksEndDate')}"/>
                                </td>
               
                            </tr>
                            <tr>
                                <td class="studentStandatrTableTd studentStandatrTableTdWithBorder">
                                    Открытие итоговых тестов
                                </td>
                                <td class="studentStandatrTableTd studentStandatrTableTdWithBorder" style="text-align:center !important;">
                                    <h:outputText converter="dateConverter" value="#{resourceService.concludingTestBeginDate}"/>
                                </td>
                                <td class="studentStandatrTableTd studentStandatrTableTdWithBorder" >
                                    Закрытие итоговых тестов
                                </td>
                                <td class="studentStandatrTableTd studentStandatrTableTdWithBorder" style="text-align:center !important;">
                                    <h:outputText converter="dateConverter" value="#{resourceService.concludingTestEndDate}"/>
                                </td>
                            </tr>
                            <tr>
                                <td class="studentStandatrTableTd studentStandatrTableTdWithBorder">
                                    Начало переэкзаменовки
                                </td>
                                <td class="studentStandatrTableTd studentStandatrTableTdWithBorder">
                                    <h:outputText converter="dateConverter" value="#{resourceService.reExameBeginDate}"/>
                                </td>
                                <td class="studentStandatrTableTd studentStandatrTableTdWithBorder">
                                    Окончание переэкзаменовки
                                </td>
                                <td class="studentStandatrTableTd studentStandatrTableTdWithBorder" style="text-align:center !important;">
                                    <h:outputText converter="dateConverter" value="#{resourceService.reExameEndDate}"/>
                                </td>
                            </tr>
                        </table>
                    </td>
                </tr>
                <tr>
                    <td colspan="2" style="height: 1px;"></td>
                </tr>
                <tr>
                    <td style=" border: 1px solid silver;" valign="top">
                        <div style=" padding: 0px 5px;max-height: 300px; overflow-y: scroll;">
                            <div style=" border-bottom: 1px solid silver; padding-top: 7px;">
                                <div class="navigationLinks indentionInNavigation"><a style="font-size: 12pt; padding-left: 24px; background:url('../resources/images/news_icon.gif') no-repeat ; " href="news_list.xhtml">Новости</a></div>
                            </div>
                            <div style="padding: 5px;">
                                <h:dataTable value="#{NewsBean.news}" var="new" style="width: 100%;">
                                    <h:column>
                                        <div style=" max-width: 60%; float: left;">
                                            <span class="controlWorksDisciplineNameLink"><a style="font-size: 9pt;" href="news_read.xhtml?id=#{new.id}">#{new.header}</a></span>
                                        </div>
                                        <span class="chatPostDate"><h:outputText converter="dateConverter" value="#{fn:substring(new.time,0,11)}"/></span>
                                        <div class="floatDestroyer"></div>
                                        <div class="previewText"><h:outputText escape="false" value="#{new.announcement}"/></div>
                                        <br/>
                                    </h:column>
                                </h:dataTable>
                            </div>
                        </div>
                    </td>
                    <td style="width: 80%;" class="StudentTimeTable" valign="top">
                        <div style=" border-bottom: 1px solid silver; padding-top: 4px;">
                            <div class="navigationLinks indentionInNavigation"><a style="font-size: 12pt; background:url('../resources/images/events.gif') no-repeat left top;  padding-left: 24px;" href="journal.xhtml" >Лента событий</a></div>
                        </div>
                        <div style=" padding: 10px; ">
                            <j:eventsOnly  list="#{journalBean.events('studentEvents',studentSessionBean.student)}"/>
                        </div>
                    </td>
                </tr>
                <tr>
                    <td colspan="2" class="indexChangeSemestrPanel">
                        <est:changeSemester semester="#{lowGradedDisciplinesBean.semester}"/>
                    </td>
                </tr>
                <tr>
                    <td style="width: 50%;" class="StudentSecondLineBlocks" valign="top">
                        <div style=" border-bottom: 1px solid silver; padding-top: 4px; padding-left: 10px;">
                            <div class="navigationLinks indentionInNavigation" style="font-family: Arial; color: #27587F; background:url('../resources/images/discipline.gif') no-repeat;  padding-left: 24px;">Дисциплины</div>
                        </div>                        
                        <div style=" padding-left: 10px; ">
                        <h:dataTable columnClasses="studentStandatrTableTd studentStandatrTableTdTests,
                                      studentStandatrTableTdLastTdwithBorder " styleClass="studentStandatrTable studentStandatrTableBorder"
                                     style="width: 100%;"
                                     value="#{lowGradedDisciplinesBean.lowGradedDisciplines}" var="p" cellpadding="0" cellspacing="0">
                        <h:column>
                            <div>
                                <div class="controlWorksDisciplineNameLink">
                                            <div>
                                                <h:outputLink value="discipline.xhtml?c=#{p.points.curriculum.id}" >#{p.points.curriculum.discipline.name} </h:outputLink> <span class="linkToTeachersProfile linkToTeachersProfileFromStudent"><h:outputLink value="teacher.xhtml?id=${p.teacher.id}">#{p.teacher.initials}</h:outputLink></span>

                                            </div>
                                </div>
                                <div class="educ_content_title_activ" >
                                    <ol class="my_educ_disc_reason">
                                        <h:panelGroup rendered="#{p.grade!=null}">
                                            <li style=" background:url('../resources/images/star.gif') no-repeat 0px 0px; padding-left: 17px; padding-bottom: 3px;" >итоговая оценка
                                            <h:outputText converter="enumConverter" value="#{p.grade}"/>
                                        </li>
                                        </h:panelGroup>
                                        <li style=" background:url('../resources/images/discipline_summ.gif') no-repeat 0 0px; padding-left: 17px; padding-bottom: 3px;">сумма баллов <h:outputText rendered="#{p.points.sum!=0}" style=" color: #373E3F;font-weight: bolder;" value="#{p.points.sum}"/>
                                        <h:outputText rendered="#{p.points.sum==0}" style="color:red; font-weight: bolder;" value="#{p.points.sum}"/>
                                        </li>

                                    </ol>
                                </div>
                            </div>
                            </h:column>
                        </h:dataTable>
                        </div>
                    </td>
                    <td style="width: 50%; padding: 3px 3px 0px 3px; border: 1px solid silver;" valign="top">
                        <div style=" border-bottom: 1px solid silver; padding-top: 4px; padding-left: 10px;">
                            <div class="navigationLinks indentionInNavigation" style="font-family: Arial; color: #27587F;   background:url('../resources/images/test_results.gif') no-repeat;  padding-left: 24px;">Результаты тестов</div>
                        </div>
                        <div style=" padding-left: 10px; ">
                        <h:dataTable cellpadding="0" cellspacing="0"
                                     columnClasses="studentStandatrTableTd studentStandatrTableTdTests,
                                      studentStandatrTableTdLastTdwithBorder " styleClass="studentStandatrTable studentStandatrTableBorder"
                                     style="width: 100%;"
                                     value="#{badPassedTestsBean.badPassedTests(false)}" var="r">
                            <h:column>
                            <div>
                                <div class="controlWorksDisciplineNameLink">
                                    <div>
                                        #{r.work.title}
                                    </div>
                                </div>
                                <div class="educ_content_title_activ">
                                    <ol class="my_educ_disc_reason">
                                        <li style="background:url('../resources/images/discipline_summ.gif') no-repeat 0 0px; padding-left: 17px; padding-bottom: 3px;">набрано баллов <h:outputText rendered="#{r.pointsForWork!=0}" style="color:#373E3F; font-weight: bolder;" value="#{r.pointsForWork}"></h:outputText>
                                    <h:outputText rendered="#{r.pointsForWork==0}" style="color:red; font-weight: bolder;" value="#{r.pointsForWork}"></h:outputText></li>
                                    </ol>
                                </div>
                            </div>
                            </h:column>
                        </h:dataTable>
                            </div>
                    </td>
                </tr><tr>
                    <td style="width: 50%; padding: 3px 3px 0px 3px; border: 1px solid silver;" valign="top">
                        <div style=" border-bottom: 1px solid silver; padding-top: 4px; padding-left: 10px;">
                            <div class="navigationLinks indentionInNavigation" style="font-family: Arial; color: #27587F;   background:url('../resources/images/test_result.gif') no-repeat;  padding-left: 24px;">Результаты итоговых тестов</div>
                        </div>
                        <div style=" padding-left: 10px; ">
                        <h:dataTable cellpadding="0" cellspacing="0"
                                     columnClasses="studentStandatrTableTd studentStandatrTableTdTests,
                                      studentStandatrTableTdLastTdwithBorder" styleClass="studentStandatrTable studentStandatrTableBorder"
                                     style="width: 100%;"
                                     value="#{badPassedTestsBean.badPassedTests(true)}" var="r">
                            <h:column>
                            <div>
                                <div class="controlWorksDisciplineNameLink">
                                    <div>
                                        #{r.work.title}
                                    </div>
                                </div>
                                <div class="educ_content_title_activ">
                                    <ol class="my_educ_disc_reason">
                                        <li  style="background:url('../resources/images/discipline_summ.gif') no-repeat 0 0px; padding-left: 17px; padding-bottom: 3px;">набрано баллов<h:outputText rendered="#{r.pointsForWork!=0}" style="color:#373E3F; font-weight: bolder; margin-left: 3px;" value="#{r.pointsForWork}"></h:outputText>
                                    <h:outputText rendered="#{r.pointsForWork==0}" style="color:red; font-weight: bolder;margin-left: 3px;" value="#{r.pointsForWork}"></h:outputText></li>
                                    </ol>
                                </div>
                            </div>
                            </h:column>
                        </h:dataTable>
                        </div>
                    </td>

                    <td style="width: 50%; padding: 3px 3px 0px 3px; border: 1px solid silver;" valign="top">
                        <div style=" border-bottom: 1px solid silver; padding-top: 4px;">
                            <div class="navigationLinks indentionInNavigation"><a style="font-size: 12pt;  background:url('../resources/images/control_works.gif') no-repeat;  padding-left: 24px;" href="controlWorks.xhtml">Мои контрольные </a></div>
                        </div>
                        <div style=" padding-left: 10px; ">
                        <h:dataTable columnClasses="studentStandatrTableTd studentStandatrTableTdTests,
                                      studentStandatrTableTdLastTdwithBorder " styleClass="studentStandatrTable studentStandatrTableBorder"
                                     style="width: 100%;"
                                     value="#{lowGradedCwBean.works}" var="w" cellpadding="0" cellspacing="0">
                        <h:column>
                            <div>
                                <div class="controlWorksDisciplineNameLink">
                                            <div>
                                                <h:outputLink value="discipline.xhtml?c=#{w.key.id}">#{w.key.discipline.name}</h:outputLink>
                                            </div>
                                </div>
                                <div class="educ_content_title_activ" >
                                    <ol class="my_educ_disc_reason">
                                        <h:panelGroup rendered="#{w.value ne null}">
                                            <li style=" background:url('../resources/images/star.gif') no-repeat 0px 0px; padding-left: 17px; padding-bottom: 3px;" >Контрольная
                                            <h:outputText converter="enumConverter" value="#{w.value.progress}"/>
                                            </li>
                                            <li style=" background:url('../resources/images/discipline_summ.gif') no-repeat 0 0px; padding-left: 17px; padding-bottom: 3px;">Получено баллов <span style=" color: #373E3F;font-weight: bolder;">#{w.value.points}</span></li>
                                        </h:panelGroup>
                                        <h:panelGroup rendered="#{empty w.value}" >
                                            <li style=" background:url('../resources/images/discipline_summ.gif') no-repeat 0 0px; padding-left: 17px; padding-bottom: 3px;">Контрольная работа не выполнена</li>
                                        </h:panelGroup>
                                    </ol>
                                </div>
                            </div>
                            </h:column>
                        </h:dataTable>
                        </div>
                    </td>
                </tr>
            </table>
        </div>
    </ui:define>
</ui:composition>
