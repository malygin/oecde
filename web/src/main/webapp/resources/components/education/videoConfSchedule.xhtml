<?xml version='1.0' encoding='UTF-8' ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:composite="http://java.sun.com/jsf/composite"
      xmlns:h="http://java.sun.com/jsf/html"
      xmlns:f="http://java.sun.com/jsf/core"
      xmlns:ui="http://java.sun.com/jsf/facelets"
      xmlns:util="http://java.sun.com/jsf/composite/components/util"
      xmlns:fn="http://java.sun.com/jsp/jstl/functions"
      >


    <!-- INTERFACE -->
    <composite:interface>
        <composite:attribute  name="numberLessons"  required="true" type="int" shortDescription="количество выводимых занятий"/>
        <composite:attribute name="styleForShedule" default="" type="java.lang.String" shortDescription="обтекание слева или без него"/>
        <composite:attribute name="renderBlock" default="" type="java.lang.String" shortDescription="что надо отобразить на странице"/>
        <composite:attribute name="ClassStyle" default="" type="java.lang.String" shortDescription="граница на главной странице"/>



    </composite:interface>

    <!-- IMPLEMENTATION -->
    <composite:implementation>
        <link type="text/css" href="../resources/jquery/css/ui-lightness/jquery-ui-1.8.14.custom.css" rel="stylesheet" />
        <script type="text/javascript" src="../resources/jquery/js/jquery-1.5.1.min.js"></script>
        <script type="text/javascript" src="../resources/jquery/js/jquery-ui-1.8.14.custom.min.js"></script>
        <script type="text/javascript" src="../resources/jquery/js/jquery.ui.datepicker-ru.js"></script>
        <script type="text/javascript">
                $(function(){
                        $('#datepicker').datepicker({
                                inline: true,
                                onChangeMonthYear: function(year, month, inst) {
                                        window.setTimeout('repaint()',1);
                                }
                        });
                        repaint();
                });
		
                function repaint(){
                        //ajax-query для получения списка дней данного месяца
                        daysArray = [["2", 7, "discipline", "teacher"], ["5", 7, "discipline", "teacher"], ["17", 7, "discipline", "teacher"], ["29", 7, "discipline", "teacher"]];

                                $('a.ui-state-default[href="#"]').each(function(){
                                        if($(this).html() == daysArray[0][0]){
                                                $(this).parent().attr('class',"lectures");
                                                daysArray=daysArray.slice(1);
                                                if(daysArray.length==0) return false;
                                        }
                                });

                                $('#datepicker td').each(function(){
                                        $(this).removeAttr("onclick");
                                });
                        }

        </script>


        <div>
            <div class="mainStudentPageTitlesGreen mainStudentPageTitles">
                <a style="font-size: 12pt;" href="schedule.xhtml">Расписание видеоконференций</a>
            </div>
            <div class="#{cc.attrs.styleForShedule}">
                <div id="datepicker" class="datepickerClass"></div>
            </div>
            <div class="videoConfSchedule floatLeft" style="min-height: 212px; width: 60%;">
                <table class="#{cc.attrs.ClassStyle}">
                    <ui:repeat var="s" value="#{studentScheduleBean.schedule(40,true)}" >
                        <tr>
                            <td valign="top" class="Ipsilon_Web_GreenText"><p><h:outputText value="#{s.lessonDate}" converter="dateConverter"/></p>
                            </td>
                            <td><p><p class="skyBlueText">#{s.discipline.name}</p> <p  class="Ipsilon_Web_GreenText">#{s.teacher.initials}</p> <h:outputText converter="roomConverter" value="#{s.room}"/> комната</p>
                            </td>
                        </tr>

                    </ui:repeat>
                    <tr>
                        <td colspan="2">
                            <p class="videoConfSchedule" style="height: 25px;">
                                <h:panelGroup rendered="#{cc.attrs.renderBlock eq 'firstLessons'}"><a href="schedule.xhtml">Посмотреть все видеоконференции</a></h:panelGroup>
                            </p>
                        </td>
                    </tr>
                </table>
            </div>
            <h:panelGroup layout="block" rendered="#{cc.attrs.renderBlock eq 'allLessons'}" style="float: right; width: 25%; margin: 0; margin-right: 10px; margin-top: 20px;" styleClass="StudentMainPageTitlesBorders">
                    <div class="interfaceContentForMyMarks">
                        <div class="mainStudentPageTitles  mainStudentPageTitlesOrange">
                            Текущая конференция
                        </div>
                    </div>
                    <div>
                        <div style="text-align: right;">
                            <a href="#" style="margin-right: 10px;">посетить</a>
                        </div>
                        <div>
                        </div>
                        
                    </div>
                    <div class="textForPodskazka">
                        <p>&nbsp;</p>
                        <p style="color:#838383">&nbsp;</p>
                    </div>
            </h:panelGroup>
            <div class="floatDestroyer"/>
            <h:panelGroup rendered="#{cc.attrs.renderBlock eq 'allLessons'}">
                <f:metadata>
                    <f:viewParam name="pageNumber" value="#{studentScheduleBean.pageNumber}"/>
                </f:metadata>
                <div class="interfaceContent">
                    <util:navigationList numElements="#{studentScheduleBean.count(true)}" elementOnPage="40"/>


                    <ui:repeat var="s" value="#{studentScheduleBean.schedule(40,true)}">
                        <h:panelGroup rendered="#{studentScheduleBean.IsCurrentDate(s.lessonDate)}">
                            <div class="greenText"><h:outputText value="#{fn:substring(s.lessonDate,0,10)}" converter="dateConverter"/></div>
                        </h:panelGroup>
                        <table class="tableForShedule">
                            <tr>
                                <td>${fn:substring(s.lessonDate,11,16)}-${fn:substring(s.lessonEndDate,11,16)}</td>
                                <td><span class="linkToStudentsProfile"><h:outputLink value="umk.xhtml?c=#{s.id}" style="margin-left: 10px;">#{s.discipline.name}
                                        </h:outputLink></span></td>
                                <td><span class="linkToTeachersProfile linkToTeachersProfileFromStudent"><a href="teacher.xhtml?id=#{s.teacher.id}"><h:outputText value="#{s.teacher.initials}"/></a></span></td>
                                <td><h:outputText converter="roomConverter" value="#{s.room}"/> комната</td>
                            </tr>
                        </table>
                    </ui:repeat>





                    <!--
                    <h:dataTable columnClasses="
                                     studentStandatrTableTd,
                                     studentStandatrTableTd,
                                     studentStandatrTableTd,
                                    studentStandatrTableTdLastTd  studentStandatrTableExamin "
                                     value="#{studentScheduleBean.schedule(40,true)}" var="s" styleClass="studentStandatrTable studentStandatrTableExamin" cellpadding="0" cellspacing="0">
                            <h:column>

                                <span class="linkToStudentProfile" style="font-size: 8pt; font-weight: normal;display:  block; padding-left: 8px;"><h:outputText value="#{s.discipline.name}"/></span>
                            </h:column>
                            <h:column>

                                <span class="linkToTeachersProfile linkToTeachersProfileFromStudent" style="background: none;"><a href="teacher.xhtml?id=#{s.teacher.id}"><h:outputText value="#{s.teacher.initials}"/></a></span>
                            </h:column>
                            <h:column>

                                <div style="text-align: center !important;">
                                    <h:outputText converter="roomConverter" value="#{s.room}" style="color: #{s.color}"/>
                                </div>
                            </h:column>
                            <h:column>

                                <span ><h:outputText converter="dateConverter" value="#{s.lessonDate}"/> - <h:outputText converter="dateConverter" value="#{s.lessonEndDate}"/></span>
                            </h:column>
                        </h:dataTable>-->


                    <util:navigationList numElements="#{studentScheduleBean.count(true)}" elementOnPage="40"/>
                </div>
            </h:panelGroup>




        </div>

        <!--                        <h:dataTable columnClasses="
                                             studentStandatrTableTd studentStandatrTableTdWithBorder,
                                             studentStandatrTableTd studentStandatrTableTdWithBorder,
                                             studentStandatrTableTd studentStandatrTableTdWithBorder,
                                             studentStandatrTableTd studentStandatrTableTdWithBorder,
                                             studentStandatrTableTdLastTd studentStandatrTableTdLastTdwithBorder"
                                             value="#{studentScheduleBean.schedule(cc.attrs.numberLessons,false)}" var="s" styleClass="studentStandatrTable studentTableEvent" cellpadding="0" cellspacing="0">
                                    <h:column>
                                        <f:facet name="header">
                                            <h:outputText value="#{msgs.student_Dicipline}"/>
                                        </f:facet>
                                        <span class="controlWorksDisciplineNameLink" >
                                            <h:outputLink value="umk.xhtml?c=#{s.id}" style="margin-left: 10px;">#{s.discipline.name}
                                            </h:outputLink>
                                         </span>
                                    </h:column>
                                    <h:column>
                                        <f:facet name="header">
                                            <h:outputText value="#{msgs.student_Teacher}"/>
                                        </f:facet>
                                        <div style="text-align: center !important;">
                                            <span class="linkToTeachersProfile linkToTeachersProfileFromStudent"><a href="teacher.xhtml?id=#{s.teacher.id}" style="text-indent: 22px;"><h:outputText value="#{s.teacher.initials}"/></a></span>
                                        </div>
                                    </h:column>
                                    <h:column>
                                        <f:facet name="header">
                                            <h:outputText value="#{msgs.student_Room}"/>
                                        </f:facet>
                                        <div class="centerAlignText">
                                            <h:outputText converter="roomConverter" value="#{s.room}" style="color: #{s.color}"/>
                                        </div>
                                    </h:column>
                                    <h:column>
                                        <f:facet name="header">
                                            <h:outputText value="#{msgs.student_lessonType}"/>
                                        </f:facet>
                                        <div class="centerAlignText">
                                            <h:outputText converter="enumConverter" value="#{s.lessonType}" />
                                        </div>
                                    </h:column>
                                    <h:column>
                                        <f:facet name="header">
                                            <h:outputText value="#{msgs.student_Data}"/>
                                        </f:facet>
                                        <div class="centerAlignText" style="font-size: 7pt;">
                                        <h:outputText converter="dateConverter" value="#{s.lessonDate}"/><br/> -<br/><h:outputText converter="dateConverter" value="#{s.lessonEndDate}"/>
                                        </div>
                                    </h:column>
                                </h:dataTable>-->

    </composite:implementation>
</html>