<?xml version='1.0' encoding='UTF-8' ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
    xmlns:composite="http://java.sun.com/jsf/composite"
    xmlns:h="http://java.sun.com/jsf/html"
    xmlns:f="http://java.sun.com/jsf/core"
    xmlns:c="http://java.sun.com/jsp/jstl/core">

 <!-- INTERFACE -->
  <composite:interface>
    <composite:attribute  name="list"/>
  </composite:interface>

  <!-- IMPLEMENTATION -->
    <composite:implementation>

        <h:outputText rendered="#{messageDialogBean.noDialog}" value="У Вас нет переписка с этим пользователем"/>
        
        <h:panelGroup rendered="#{not messageDialogBean.noDialog}">
            <h:form>
                <a href="messages_write.xhtml?user=#{messageDialogBean.recipient.recipient.id}">Полный режим</a> <br/>
                <h:outputText rendered="#{MessageWriteBean.renderSuccessSend}" value="Сообщение успешно послано"/>
                <h:inputText  value="#{MessageWriteBean.theme}"/><br/>
                <h:inputTextarea value="#{MessageWriteBean.fullText}"/><br/>
                <h:commandButton action="#{MessageWriteBean.save}" value="save!">
                    <f:setPropertyActionListener target="#{MessageWriteBean.recipient_id}" value="#{messageDialogBean.recipient.recipient.id}"/>
                    <f:ajax execute="@form" render="@form" />
                </h:commandButton>
            </h:form>
             собеседник #{messageDialogBean.recipient.fioAuthor}<br/><br/><br/>
            <c:forEach  items="#{cc.attrs.list}" var="message">
              <c:if test="#{message.fioAuthor==messageDialogBean.recipient.fioAuthor}"><b>ОН</b></c:if>
              <c:if test="#{message.fioAuthor!=messageDialogBean.recipient.fioAuthor}"><b>Я</b></c:if>
              <h:outputText value="#{message.message.theme}"/>
              <small><h:outputText value="#{message.message.dateMessage}"/></small><br/>
              <h:outputText value="#{message.message.fullText}"/><br/><br/>  
            </c:forEach>
        </h:panelGroup>
  </composite:implementation>
</html>