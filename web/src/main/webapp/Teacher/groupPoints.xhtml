<ui:composition
    xmlns:ui="http://java.sun.com/jsf/facelets"
    xmlns:f="http://java.sun.com/jsf/core"
    xmlns:h="http://java.sun.com/jsf/html"
    template="../resources/teacherTemplate.xhtml"
    xmlns:est="http://java.sun.com/jsf/composite/components/estimation"
     xmlns:tabs="http://java.sun.com/jsf/composite/components/tabs">

    <ui:define name="contentHeader">
        #{msgs.teacher_groupInfo}
    </ui:define>

    <ui:define name="content">
        <div class="interfaceContent StudentMainPageTitlesBorders">
            <div class="mainStudentPageTitles  mainStudentPageTitlesGreen">
                <p class="mainStudentPageTitles Ipsilon_Web_GreenText">
                    #{msgs.teacher_groupInfo} <h:outputText value="#{groupPoints.group.name}"/> (<h:outputText value="#{groupPoints.group.speciality.name}" />)
                </p>
                <div class="backLink greyLinks massSending">
                    <a href="messages_write.xhtml?gr=#{groupPoints.id}">#{msgs.teacher_groupSendAll}</a> | 
                    <a href="http://oec.sgu.ru/ipsilonUmk/grades_report.php?c=#{groupPoints.curriculum.id}&amp;g=#{groupPoints.id}">Скачать ведомость</a>
                </div>
                <div class="floatDestroyer"></div>
            </div>
            <f:metadata>
                <f:viewParam name="s" value="#{teachersGroups.semester}"/>
                <f:viewParam name="s" value="#{groupPoints.semester}"/>
                <f:viewParam name="g" value="#{groupPoints.id}"/>
                <f:viewParam name="c" value="#{groupPoints.curriculumId}"/>
            </f:metadata>
            <div class="groupInfo">
                <est:header bean="#{groupPoints}" pageName="points"/>
            </div>
            <h:form rendered="#{not groupPoints.accessDenied}" id="form" prependId="false" style="margin: 10px; margin-top: 0;">
                <h:dataTable styleClass="studentStandatrTable"
                             columnClasses="studentStandatrTableTd studentStandatrTableTdPaddingTeacher,
                             studentStandatrTableTd studentStandatrTableExamin studentStandatrTableTdPaddingTeacher,
                             studentStandatrTableTd studentStandatrTableExamin studentStandatrTableTdPaddingTeacher,
                             studentStandatrTableTd studentStandatrTableExamin studentStandatrTableTdPaddingTeacher,
                             studentStandatrTableTd studentStandatrTableExamin studentStandatrTableTdPaddingTeacher,
                             studentStandatrTableTd studentStandatrTableExamin studentStandatrTableTdPaddingTeacher,
                             studentStandatrTableTd studentStandatrTableExamin studentStandatrTableTdPaddingTeacher,
                             studentStandatrTableTd studentStandatrTableExamin studentStandatrTableTdPaddingTeacher,
                             studentStandatrTableTd studentStandatrTableExamin studentStandatrTableTdPaddingTeacher,
                             studentStandatrTableTdLastTd studentStandatrTableExamin studentStandatrTableTdWidthTeacher studentStandatrTableTdPaddingTeacher" cellpadding="0" cellspacing="0" id="table" value="#{groupPoints.points}" var="p" style="margin: 0;">
                    <h:column>
                        <f:facet name="header">
                            <h:outputText value="#{msgs.student_Student}" />
                        </f:facet>
                        <span class="linkToStudentsProfile"><h:outputLink value="student.xhtml?id=#{p.points.student.id}&amp;s=#{groupPoints.semester}">#{p.points.student.initials}</h:outputLink></span>
                    </h:column>

                    <h:column>
                        <f:facet name="header">
                            <h:outputText value="#{msgs.student_gradesTableHeadTests}" />
                        </f:facet>
                        <h:panelGroup rendered="#{(p.test ne null)}">
                            <h:panelGroup rendered="#{(p.test*100/(p.testsMaxPoints) ge 0) and (p.test*100/(p.testsMaxPoints) le 50)}" styleClass="badResultText">#{p.test}</h:panelGroup>
                            <h:panelGroup rendered="#{(p.test*100/(p.testsMaxPoints) gt 50) and (p.test*100/(p.testsMaxPoints) le 90)}" styleClass="goodResultText">#{p.test}</h:panelGroup>
                            <h:panelGroup rendered="#{(p.test*100/(p.testsMaxPoints) gt 90)}" styleClass="greateResultText">#{p.test}</h:panelGroup>
                            <span class="lightGreyTestText">#{msgs.student_From} #{p.testsMaxPoints}</span>
                        </h:panelGroup>
                       
                    </h:column>

                    <h:column>
                        <f:facet name="header">
                            <h:outputText value="#{msgs.teacher_groupTestsExtraAttempt}" />
                        </f:facet>
                        <h:panelGroup rendered="#{(p.reTest ne null)}">
                            <h:panelGroup rendered="#{(p.reTest*100/(p.testsMaxPoints) ge 0) and (p.reTest*100/(p.testsMaxPoints) le 50)}" styleClass="badResultText">#{p.reTest}</h:panelGroup>
                            <h:panelGroup rendered="#{(p.reTest*100/(p.testsMaxPoints) gt 50) and (p.reTest*100/(p.testsMaxPoints) le 90)}" styleClass="goodResultText">#{p.reTest}</h:panelGroup>
                            <h:panelGroup rendered="#{(p.reTest*100/(p.testsMaxPoints) gt 90)}" styleClass="greateResultText">#{p.test}</h:panelGroup>
                      
                        </h:panelGroup>
                      
                    </h:column>

                    <h:column>
                        <f:facet name="header">
                            <span class="Ipsilon_Web_GreenText">#{msgs.teacher_groupMainTests} <br/>#{msgs.teacher_groupTests}</span>
                        </f:facet>
                        <h:panelGroup rendered="#{(p.concludingTest) ne null}" style="#{(p.concludingReTest ne null)?'text-decoration: line-through;':''}" >
                            <h:panelGroup rendered="#{(p.concludingTest*100/(100) ge 0) and (p.concludingTest*100/(100) le 50)}" styleClass="badResultText">#{p.concludingTest}</h:panelGroup>
                            <h:panelGroup rendered="#{(p.concludingTest*100/(100) gt 50) and (p.concludingTest*100/(100) le 90)}" styleClass="goodResultText">#{p.concludingTest}</h:panelGroup>
                            <h:panelGroup rendered="#{(p.concludingTest*100/(100) gt 90)}" styleClass="greateResultText">#{p.concludingTest}</h:panelGroup>
                            <span class="lightGreyTestText">#{msgs.student_From} #{p.concludingTestsMaxPoints}</span>
                        </h:panelGroup>
                      
                    </h:column>

                    <h:column>
                        <f:facet name="header">
                            <span class="Ipsilon_Web_GreenText">#{msgs.teacher_groupTestsExtraAttempt}<br/>#{msgs.teacher_groupForMainTests}<br/>#{msgs.teacher_groupForTests}
                            </span>
                        </f:facet>
                       <h:panelGroup rendered="#{(p.concludingReTest) ne null}">
                            <h:panelGroup rendered="#{(p.concludingReTest*100/(100) ge 0) and (p.concludingReTest*100/(100) le 50)}" styleClass="badResultText">#{p.concludingReTest}</h:panelGroup>
                            <h:panelGroup rendered="#{(p.concludingReTest*100/(100) gt 50) and (p.concludingReTest*100/(100) le 90)}" styleClass="goodResultText">#{p.concludingReTest}</h:panelGroup>
                            <h:panelGroup rendered="#{(p.concludingReTest*100/(100) gt 90)}" styleClass="greateResultText">#{p.concludingReTest}</h:panelGroup>
                            <span class="lightGreyTestText">#{msgs.student_From} #{p.concludingTestsMaxPoints}</span>
                        </h:panelGroup>
                    </h:column>
                    
                     <h:column>
                        <f:facet name="header">
                            <span class="Ipsilon_Web_GreenText">#{msgs.teacher_groupGruopExtraPoints}</span>
                        </f:facet>
                     <h:inputText maxlength="3" size="3" value="#{p.activityPoints}"/> 

                    </h:column>
                    
                    
                    <h:column>
                        <f:facet name="header">
                            <span class="Ipsilon_Web_GreenText">#{msgs.teacher_control_works},<br/> #{msgs.teacher_groupPoints}
                            </span>
                        </f:facet>
                        <span>#{p.controlWorkPoints}</span>
                    </h:column>

                    <h:column>
                        <f:facet name="header">
                            <span class="Ipsilon_Web_GreenText">#{msgs.teacher_control_works},<br/> #{msgs.teacher_groupMarks}
                            </span>
                        </f:facet>
                        <span><h:outputText converter="enumConverter" value="#{p.controlWorkValue}" /></span>
                    </h:column>

                    <h:column>
                        <f:facet name="header">
                            <h:outputText value="#{msgs.student_gradesTableHeadSumm}" />
                        </f:facet>
                        <h:panelGroup rendered="#{((p.points.sum) ne null) and ((p.points.sum) ne 0)}">
                        
                            <h:panelGroup rendered="#{(p.points.sum*100/(p.testsMaxPoints+p.concludingTestsMaxPoints+p.controlWorkMaxPoints+100) ge 0) and (p.points.sum*100/(p.testsMaxPoints+p.concludingTestsMaxPoints+p.controlWorkMaxPoints+100) le 50)}" styleClass="badResultText">#{p.points.sum}</h:panelGroup>
                            <h:panelGroup rendered="#{(p.points.sum*100/(p.testsMaxPoints+p.concludingTestsMaxPoints+p.controlWorkMaxPoints+100) gt 50) and (p.points.sum*100/(p.testsMaxPoints+p.concludingTestsMaxPoints+p.controlWorkMaxPoints+100) le 90)}" styleClass="goodResultText">#{p.points.sum}</h:panelGroup>
                            <h:panelGroup rendered="#{(p.points.sum*100/(p.testsMaxPoints+p.concludingTestsMaxPoints+p.controlWorkMaxPoints+100) gt 90)}" styleClass="greateResultText">#{p.points.sum}</h:panelGroup>
                            <span class="lightGreyTestText">#{msgs.student_From} #{p.testsMaxPoints+p.concludingTestsMaxPoints+p.controlWorkMaxPoints+100}</span>
                        </h:panelGroup>
                        
                    </h:column>

                    <h:column>
                        <f:facet name="header">
                            <h:outputText value="Результат" />
                        </f:facet>
                        <p style="width: 100px; text-align: center;"><h:selectOneMenu id="grade" value="#{p.grade}">
                            <f:selectItems value="#{groupPoints['enum']}" />
                        </h:selectOneMenu></p>
                    </h:column>
                </h:dataTable>

                <div style="text-align: right; padding: 5px; ">
                    <h:commandButton id="btn" value="#{msgs.teacher_saveButton}" styleClass="studentButton">
                        <f:ajax execute="@form" render="@form" listener="#{groupPoints.save}"/>
                    </h:commandButton>
                </div>
                <h:outputText id="error" rendered="#{groupPoints.error}" value="#{msgs.teacher_errorMessage}"/>
                <h:outputText id="saved" rendered="#{groupPoints.saved}" value="#{msgs.teacher_successSavingMessage}"/>
            </h:form>
        </div>
        <div class="StudentMainPageTitlesBorders">
            <div class="interfaceContentForMyMarks">
                <div class="mainStudentPageTitles  mainStudentPageTitlesSkyBlue">
                   #{msgs.student_marksHelp}
                </div>
            </div>
            <div class="textForPodskazka">
                <tabs:singleTab alias="TEACHER_GROUP_MARKS"/>
            </div>
        </div>
    </ui:define>
</ui:composition>